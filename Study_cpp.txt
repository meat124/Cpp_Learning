7-1강 C++ 에서의 입출력(istream, ostream)

io_base 와 ios 클래스는 입출력 작업을 위해 바탕을 깔아주는 클래스이다.
istream은 실제로 입력을 수행하는 클래스이다.

-istream 클래스

대표적으로 우리가 항상 사용하던 operator>> 가 istream 클래스에 정의되어 있는 연산자이다.
cin은 istream 클래스의 객체 중 하나이다.

우리가 어떤 타입에 대해서도 cin을 사용할 수 있었더 이유는 operator>> 가 그런 모든 기본 타입들에 대해서 정의가 되어있고 따라서 오버로딩이 수행되어서 자동으로 맞는 타입을 찾아가기 때문이다.
정의가 되어있지 않은 타입이라도 string 클래스로 선언된 문자열의 경우도 cin으로 입력을 받을 수 있다.
이는 외부 함수로도 연산자 오버로딩이 가능하기 때문이다.
이 경우는
istream& operator>>(istream& in, std::string& s)
{
...
}
으로 나타날 것이다.

operator>> 의 또 다른 특징으로는,  모든 공백문자(띄어쓰기나 엔터, 탭 등등) 을 입력시에 무시해버린다는 점이다. 그렇기 때문에 만일 cin을 통해서 문장을 입력받는다면, 첫 단어만 입력받고 나머지를 읽을 수 없다.

ios 클래스에서 스트림의 상태를 관리한다. 스트림의 상태를 관리하는 플래그가 4개가 정의되어있다.
goodbit : 스트림에 입출력 작업이 가능할 때
badbit : 스트림에 복구 불가능한 오류 발생 시
failbit : 스트림에 복구 가능한 오류 발생 시
eofbit : 입력 작업시에 EOF 도달 시

만약 타입에 맞지 않는 값이 넣어져서 오류가 발생하면 failbit 가 켜지고 입력값을 받지 않고 리턴해버린다.

operator void*() const; 함수는 ios 객체를 void* 로 변환해준다. 이때 NULL 포인터가 아닌 값을 리턴하는 조건은 failbit 와 badbit 가 모두 off일 때 이다. 즉 스트림에 정상적으로 입출력 작업을 수행 할 수 있을 때이다.

fail 함수는 ios에 정의되어있다. failbit 나 badbit 가 true 이면 true를 리턴한다.
ignore 함수는 첫번째 인자 만큼, 두 번째 인자가 나올 때 까지 버퍼에서 무시하는 함수이다.

16진수로 값을 입력받는 또 다른 방법이 있다.
std::cin >> std::hex >> t;
이렇게 하면 hex 가 cin 에서 수를 받는 방식을 바꾸기 때문에 16진수로 받을 수 있다.
이 때문에 hex와 같은, 스트림을 조작하여 입력 혹은 출력 방식을 바꿔주는 함수를 조작자라고 부른다.(hex는 함수이다.) 참고로 ios_base::hex 와 std::hex는 아예 다른 것이다.
형식 플래그 ios_base::hex는 ios_base에 선언되어 있는 단순한 상수 값이지만, 조작자 hex의 경우 ios 에 정의되어 있는 함수이다. 이 조작자 hex의 정의를 살펴보면 ios_base 객체를 레퍼런스로 받고, 다시 그 객체를 리턴한다.
std::ios_base& hex(std::ios_base& str);
그렇다면 operator>> 중에서 위 함수를 인자로 가지는 경우도 있을까?
존재한다.
istream& operator>>(ios_base& (*pf)(ios_base));
이렇게 operator>> 에서 조작자를 받는다면 많은 일을 하는 것이 아니라 단순히 pf(*this) 를 호출하게 된다.
따라서 setf를 사용하지 않더라도 간단하게 조작자를 사용하여 쉽게 입력 형식을 바꿀 수 있다.
조작자들의 종류는 hex말고도 매우 많다. true나 falseㅇ를 1과 0으로 처리하는 대신, 문자열 그대로 입력받는 boolalpha도 있고, 출력 형식으로 왼쪽 또는 오른쪽으로 정렬시키는 left와 right 조작자 등 여러가지가 존재한다.
그 외에도 우리가 계속 사용했던 std::endl도 있다. endl은 hex와 달리 출력을 관장하는 ostream 클래스에 정의되어있는 조작자로, 한 줄 개행문자를 출력하는 것 말고도, 버퍼를 모두 내보내는 flush 역활도 수행한다.
버퍼에 데이터가 얼마나 쌓이든지 상관없잉 바로 출력을 해주는 함수인 flush 함수이다.
